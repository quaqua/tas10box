<% if flash[:notice] %>
var doc = <%= raw @doc.to_json %>;
$('.create-form:visible input[type=text]').val('');
if( <%= params.has_key?(:keep_open) %> || $('#tas10-dialog .create-form:visible .continue-editing').hasClass('checked') )
  $('#tas10-dialog .create-form:visible .js-get-focus').focus();
else {
  tas10.dialog('close');
  $('#tas10-dialog .create-form:visible select.template option:first').attr('selected',true);
}
tas10.appendToList( doc );
$('[data-id=' + doc._id + ']').effect('highlight', { color: '#fc6' }, 2000 );
<% end %>
<%= render "common/process_flash" %>