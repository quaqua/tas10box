=form_for @user, :remote => true, :html => {:class => 'user-form tas10-form' } do |f|
  %p
    %label.desc
      =t('user.email')
    %br
    =f.text_field :email
  %p
    %label.desc
      =t('user.name')
    %br
    =f.text_field :name
  %p
    %label.desc
      =t('user.fullname')
    %br
    =f.text_field :fullname
  %p
    %label.desc
      =t('login.password')
    %br
    %label{:style => "text-transform: none"}
      = raw t('user.password_desc')
    %br
    =f.password_field :password, :class => 'new-password'
  %p
    %label.desc
      =t('login.password_confirm')
    %br
    =f.password_field :password_confirmation, :class => 'confirm-password'

  %p{ :style => "text-align:right" }
    %a{ :href => user_path(@user), :"data-remote" => true }
      =t('cancel')
    &nbsp;
    =f.submit t('save')

:javascript

  $('.user-form').on('submit', checkPassword);

  function checkPassword(){
    $('.login-container .error').removeClass('error');
    var password = $('.new-password').val();
    var confirmation = $('.confirm-password').val();
    if( password.length === 0 && confirmation.length === 0 )
      return true;
    if( password.length > 5 ){
      if( password.match(/^\w*(?=\w*\d)(?=\w*[a-z])(?=\w*[A-Z])\w*$/) ){
        if( password == confirmation )
          return true;
        else{
          $('.confirm-password').addClass('error');
          $('.new-password').addClass('error')
          $('.confirm-password').focus();
          return false;
        }
      } else
        $('.digit-error').addClass('error');
    } else
      $('.length-error').addClass('error');
    $('.new-password').focus();
    return false;
  }